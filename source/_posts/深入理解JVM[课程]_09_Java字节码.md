---
title: 09 | Java字节码
date: 2019-11-12 12:22:00
tags: [JVM]
categories :
- 学习笔记
- JVM
- 深入理解JVM[课程]
---

<center> <h4><font color = "#36648B">✎</br>字节码文件结构</center>
![](C:\Users\huangjunlong\Desktop\blog\aFightz.github.io\source\_posts\深入理解JVM[课程]_09_Java字节码\java字节码结构.png)

字节码文件由以下部分组成：

- **魔数**。所有的.class字节码文件的前4个字节都是魔数，魔数值为固定值：**0xCAFEBABE**。
- **版本号**。魔数之后的4个字节为版本信息，前两个字节表示minor version（次版本号），后两个字节表示major version（主版本号）。
- **常量池**。常量地（constant pool）：紧接着主版本号之后的就是常量池入口。一个Java类中定义的很多信息都是由常量地来维护和描述的，比如说Java类中定义的方法与变量信息，都是存储在常量池中。
  常量池中主要存储两类常量：
  
  - **字面量**。如文本字符串，Java中声明为final的常量值等。
  - **符号引用**。如类和接口的全局限定名，字段的名称和描述符，方法的名称和描述符等。
  
  Java类所对应的常量池主要由**常量池数量**（其实就是数组的size）与**常量池数组**（常量表）这两部分共同构成。常量池数量紧跟在主版本号后面，占据2个字节，常量池数组则紧跟在常量池数量之后。常量池数组与一般的数组不同的是，常量池数组中可以存储不同类型的元素。每一种元素的第一个数据都是一个u1类型，该字节是个标志位，占据1个字节。JVM在解析常量池时，会根据这个u1类型来获取元素的具体类型。
常量池数组中元素的个数 = 常量池数量 - 1，因为常量池数组[0]是表示保留字**null**，不会被使用。
  
- **类信息**。
- **类的构造方法**。
- **类中的方法信息**。
- **类变量**。
- **成员变量**。




















